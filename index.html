
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Adrian Mejia&#8217;s Blog</title>
  <meta name="author" content="Adrian Mejia">

  
  <meta name="description" content="Have you ever wonder how the companies that offer free services make money? Such as Instagram, Evernote, Facebook, Twitter, LinkedIn, Google Maps, so &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://adrianmejia.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Adrian Mejia's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24183929-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Adrian Mejia&#8217;s Blog</a></h1>
  
    <h2>var life = { &#8216;work_hard&#8217;, &#8216;have_fun&#8217;, &#8216;make_history&#8217; };</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:adrianmejia.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/09/how-company-x-make-money/">How Company X Make Money?</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-03-09T21:39:42-04:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:39 pm</span></time>
        
           | <a href="/blog/2014/03/09/how-company-x-make-money/#disqus_thread"
             data-disqus-identifier="http://adrianmejia.com/blog/2014/03/09/how-company-x-make-money/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Have you ever wonder how the companies that offer free services make money? Such as Instagram, Evernote, Facebook, Twitter, LinkedIn, Google Maps, so on&hellip; or if it is even profitable to keep free users using their services. We would go through several revenue models and hopefully, it will throw you some light next time you decide to roll your own startup.</p>

<p><a href="#start">TL; DR</a>: Go to the interactive company revenue checker.</a></p>

<h3>Revenues Models</h3>

<p>Let’s start first giving some perspective what models are actually giving the most revenues. In 2013, App Store, reported that free apps brought the 71% of the revenue! Even more than paid apps… how’s that even possible!?</p>

<p><img src="/images/revenue-breakdown.png"></p>

<div style="clear:both"></div>


<p>(source:
<a href="http://techcrunch.com/2013/03/28/in-app-purchase-revenue-hits-record-high-accounts-for-76-of-u-s-iphone-app-revenue-90-in-asian-markets/" target="_blank">techcrunch</a>
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/css/base/jquery.ui.all.min.css">
<link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
<link rel="stylesheet" type="text/css" href="/stylesheets/company_revenue.css">
)</p>

<p>Ok, let’s discuss some revenue models to understand this. There are 3 main models</p>

<ul>
<li><p> <strong>Freemium</strong>: apps are free to download and use. However, quite often some different features are sold separately (e.g. new levels, specialized functions, remove ads, more capacity, and so on). E.g. Pandora, Hulu, Google Docs.</p></li>
<li><p> <strong>Premium</strong>: users paid upfront a fixed price for the application. After you pay for it, you are able to download it. Usually new software updates are free. E.g. MS Office 365.</p></li>
<li><p> <strong>Subscription</strong>: users paid a fixed price which is automatically charged every certain time. Magazines in the iOS Newsstand are a good example of this subscription based model. Subscriptions have generally lower prices than premium accounts. E.g. Netfix.</p></li>
</ul>


<p>Freemium is not as &ldquo;free&rdquo; as it might seem in the surface, there are indirect ways of getting revenues from it.</p>

<ul>
<li><p> <strong>Advertising</strong>: the application/service is free to use, but it contains ads or  interruption banners for an couple of minutes in order to raise revenue. This model is usually applied along with freemium apps and to remove the  ads users have to pay a subscription. E.g. Spotify.</p></li>
<li><p> <strong>Selling data</strong>:  user information and behavior inside the application is sell to interested 3rd-parties. Usually used with freemium apps and specified in the terms of used.</p></li>
<li><p> <strong>Transaction</strong>: the application is free to use generally and charges a percentage or fixed fee with every users’ transaction made. For example, it allows you to publish your item on their site for free but when you sell it, it charges you a fee. Or publish a project in a site and when it reaches certain goal a percentage fee is applied. E.g. eBay, Kickstarter.</p></li>
<li><p> <strong>Online lead generation</strong>:  collects user’s information sometimes in an exchange of a product or service and then resell the information to companies interested indirectly. It’s different from the selling data model because the information is not sold to 3rd party directly, but indirectly. Influencing users desitions based on 3rd party companies affiliated and users&#8217; interests, likes and behaviors. E.g. Mint, LinkedIn.</p></li>
<li><p> <strong>Donations</strong>: (it&rsquo;s self-explanatory) Services/apps are free, but it encourages users to contribute throughout donations to support the development.</p></li>
</ul>


<p>After reading these, you might have more clues why free apps are so much win nowadays. They helped to create those million-dollar-per-day games! (remembered FlappyBird, Candycrush, Farmville&hellip;) In a market where there is enough competition, having a free option will take you to large numbers of users quicker and broader, because of the low barrier to entry. For instance, Whatsapp had at certain point 10k of daily downloads, after moving it to $1 it download rate drops 10 times, they finally opted for yearly subscriptions.</p>

<p>Subscription-based revenue are also a model worth doing a special mention. It brings a steady flow of income to companies and usually comes in different tiers to fulfill users need. But, it has to be flexible enough, because it might limit hard core users which might be willing to pay more for taking the product to a new level.</p>

<p> Click at the companies logos to see if their revenue models are profitable or not. You might get surprised! If some information is not accurate please leave a comment and if you are wondering about another company not listed here, let me know and I will add it :) </p>


<p><a id="start"></a></p>

<div id="company_revenue">
  <ul id="companies-holder"></ul>
</div>




<div style="clear:both"></div>




<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>


<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>




<script type="text/javascript">
  String.prototype.titleize = function() {
    return this.replace(/_/g, " ").replace(/(?:^|\s)\S/g, function(a) { return a.toUpperCase(); });
  };
</script>




<script type="text/template" id="company-icon">
  <li class="company-item">
    <a href="#<%= name %>" class="company-icon" data-company="<%= name %>" title="How does <%= name.titleize() %> make money?">
      <span>
          <img src="/images/logo_<%= name %>.png" alt="<%= name %>">
      </span>
    </a>
  </li>
</script>




<script type="text/template" id="company-detail">
  <section id="company-details-<%= name %>" class="company-details">
    <h2>How does <%= name.titleize() %> make money?</h2>
    <input type="hidden" autofocus>
    <div>
      <ul>
        <li class="advertising revenue-<%= revenues.advertising > 0 ? 'active' : 'inactive' %>"><i class="fa fa-bullhorn"></i> Advertising</li>
        <li class="freemium revenue-<%= revenues.freemium > 0? 'active' : 'inactive' %>"><i class="fa fa-users"></i> Freemium</li>
        <li class="subscribers revenue-<%= revenues.subscribers > 0 ? 'active' : 'inactive' %>"><i class="fa fa-credit-card"></i> Subscribers</li>
        <li class="premium revenue-<%= revenues.premium > 0 ? 'active' : 'inactive' %>"><i class="fa fa-money"></i> Premium</li>
        <li class="lead_gen revenue-<%= revenues.lead_gen > 0 ? 'active' : 'inactive' %>"><i class="fa fa-random"></i> Lead Gen</li>
        <li class="transactions revenue-<%= revenues.transactions > 0 ? 'active' : 'inactive' %>"><i class="fa fa-code-fork"></i> Transactions/Royalties</li>
        <li class="selling_data revenue-<%= revenues.selling_data > 0 ? 'active' : 'inactive' %>"><i class="fa fa-globe"></i> Selling Data</li>
      </ul>
    </div>
    <div class="profitable <%= profitable ? 'active' : 'inactive' %>">
      Profitable? <%= profitable ? 'Yes' : 'No' %> <i class="fa fa-thumbs-o-<%= profitable ? 'up' : 'down' %>"></i>
      <%= revenue.length > 0 ? "<br><small>Revenue: "+revenue+"</small>" : "" %>
    </div>
    <p><small><%= description %></small></p>
    <div id="sources">
      Sources: <% _.each(sources, function(s, i){ %>
        <a href="<%= s %>" target="_blank"><%= i+1 %></a>
      <% }) %>
    </div>
  </section>
</script>




<script type="text/javascript">
var companies = [{
  name: 'instagram',
  revenues: {
    freemium: 1,
  },
  revenue: "",
  profitable: false,
  description: "Before selling to Facebook they were not making money. They are trying to incorporate Ads.",
  type: ["social-media"],
  sources: ["https://www.facebook.com/careers/department?req=a0IA000000CxvB4MAJ", "http://adage.com/article/digital/instagram-ads-a-risky-bet-facebook/244945/"]
},{
  name: 'facebook',
  revenues: {
    advertising: 0.85,
    freemium: 1,
  },
  profitable: true,
  revenue: "US$ 7.872 billion (2013)",
  description: "Advertising is the main source of revenue but also some small percentage comes from payments, web apps and other sources.",
  type: ["social-media"],
  sources: ["http://en.wikipedia.org/wiki/Facebook", "http://www.nytimes.com/2012/02/05/opinion/sunday/facebook-is-using-you.html?pagewanted=all&_moc.semityn.www&_r=0", "http://readwrite.com/2012/05/22/how-does-facebook-make-money#awesm=~oy2VCCNkvevfHC", "http://www.splatf.com/2012/02/facebook-revenue/", "http://blog.tweetsmarter.com/social-media/infographic-how-does-twitter-make-money-how-do-other-social-sites-do-it/"]
},{
  name: 'whatsapp',
  revenues: {
    advertising:0,
    freemium:1,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  profitable: true,
  revenue: "",
  description: "The company is based on Freemium model for firt year. Later, it has a subscription of $1 per year.",
  type: ["social-media"],
  sources: ["http://blogs.wsj.com/digits/2013/12/19/whatsapp-hits-400-million-users-wants-to-stay-independent/", "http://www.quora.com/WhatsApp-Messenger/How-much-revenue-is-WhatsApp-generating", "http://news.yahoo.com/whatsapp-now-making-more-money-google-play-ios-220028493.html", "http://gigaom.com/2013/07/17/why-whatsapps-new-subscription-model-makes-perfect-sense/", "http://www.buzzle.com/articles/how-does-whatsapp-make-money.html"]
},{
  name: 'twitter',
  revenues: {
    advertising: 0.85,
    freemium: 1,
  },
  profitable: true,
  revenue: "US$ 317 million (2012)",
  description: "Mostly on corporate advertising and payments from 'promoted' tweets.",
  type: ["social-media"],
  sources: ["http://blog.tweetsmarter.com/social-media/infographic-how-does-twitter-make-money-how-do-other-social-sites-do-it/", "http://www.bbc.com/news/business-24397472", ""]
},{
  name: 'kickstarter',
  revenues: {
    transactions: 1,
    // freemium: 1,
  },
  profitable: true,
  revenue: "US$ 12 million?",
  description: "Charges a 5% for successfully funded projects.",
  type: ["social-media"],
  sources: ["https://www.kickstarter.com/help", "http://qz.com/184019/how-kickstarter-users-raised-nearly-1-billion-the-really-long-tail-of-crowdfunding/"]
},{
  name: 'skype',
  revenues: {
    advertising:0,
    freemium:1,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  revenue: "US$ 740 million (2009)",
  profitable: true,
  description: "Skype-to-skype calls are free, but users can buy additional features.",
  type: ["social-media"],
  sources: ["https://support.skype.com/en/faq/FA335/how-does-skype-make-money"]
},{
  name: 'groupon',
  revenues: {
    advertising:0,
    freemium:1,
    subscribers:0,
    premium:0,
    lead_gen:0,
    transactions:1,
    selling_data:0
  },
  revenue: "US$ 2.573 billion (2013)",
  profitable: true,
  description: "Groupon takes charges a fee to seller for every deal sold. It's one of the fastest growing company in the world. Going from $30.5 million in year one to $713.4 million in year two.",
  type: ["ecommerce"],
  sources: ["http://www.reuters.com/article/2012/05/14/us-groupon-idUSBRE84D16H20120514", "http://www.incomediary.com/10-weird-ways-big-companies-make-money-online"]
},{
  name: 'ebay',
  revenues: {
    advertising:1,
    freemium:0,
    subscribers:0,
    premium:0,
    lead_gen:0,
    transactions:1,
    selling_data:0
  },
  revenue: "US$ 16.05 billion (2013)",
  profitable: true,
  description: "Fees are only applied to sellers for each transactions.",
  type: ["ecommerce"],
  sources: ["http://www.reuters.com/article/2012/05/14/us-groupon-idUSBRE84D16H20120514"]
},{
  name: 'mint',
  revenues: {
    advertising:0,
    freemium:0,
    subscribers:0,
    premium:0,
    lead_gen:1,
    transactions:0,
    selling_data:0
  },
  revenue: "",
  profitable: true,
  description: "Mint get paid a small fee when user switch to a new bank or company.",
  type: ["app"],
  sources: ["https://www.mint.com/how-it-works/free/"]
},{
  name: 'linkedin',
  revenues: {
    advertising:1,
    freemium:1,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:1
  },
  revenue: "US$1.52 billion (2013)",
  profitable: true,
  description: "Sells user's data to companies and recruiters.",
  type: ["social-media"],
  sources: ["https://intelligence.businessinsider.com/welcome"]
},{
  name: 'amazon_kindle',
  revenues: {
    advertising:0,
    freemium:0,
    subscribers:0,
    premium:1,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  revenue: "",
  profitable: false,
  description: "Amazon loses money with Kindle but at the same time makes money selling digital content on it.",
  type: ["hardware"],
  sources: [""]
},{
  name: 'microsoft_xbox',
  revenues: {
    advertising:1,
    freemium:1,
    subscribers:1,
    premium:1,
    lead_gen:0,
    transactions:1,
    selling_data:0
  },
  revenue: "",
  profitable: true,
  description: "Xbox console and games cost money (premium), charges $50 annually (subscribers) in addition to ads.",
  type: ["hardware"],
  sources: [""]
},{
  name: 'stack_overflow',
  revenues: {
    advertising:1,
    freemium:0,
    subscribers:0,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  revenue: "",
  profitable: true,
  description: "Ads, banners and sponsored results.",
  type: ["social-media"],
  sources: ["http://questions-and-answers.findthebest.com/q/17/2521/How-does-Stack-Overflow-make-money"]
},{
  name: 'netflix',
  revenues: {
    advertising:0,
    freemium:0,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  revenue: "US$4.37 billion (2013)",
  profitable: true,
  description: "Just subscribers.",
  type: ["streaming"],
  sources: [""]
},{
  name: 'pandora',
  revenues: {
    advertising:1,
    freemium:1,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  revenue: "US$274 million (2012)",
  profitable: true,
  description: "For free users presents adds, for subscribers does not.",
  type: ["streaming"],
  sources: [""]
},{
  name: 'spotify',
  revenues: {
    advertising:1,
    freemium:1,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  revenue: "",
  profitable: false,
  description: "It has been reporting loses for a couple of years due to royalty payments.",
  type: ["streaming"],
  sources: ["http://mashable.com/2012/10/05/spotify-revenues/", "http://techcrunch.com/2013/07/31/spotify-doubles-revenues-in-2012-while-losing-money-highlighting-royalty-squeeze/", "http://www.telegraph.co.uk/technology/news/10490613/Spotify-pays-500m-in-royalties-in-2013.html"]
},{
  name: 'firefox',
  revenues: {
    advertising:0,
    freemium:0,
    subscribers:0,
    premium:0,
    lead_gen:0,
    transactions:1,
    selling_data:0
  },
  revenue: "US$311 million (2012)",
  profitable: true,
  description: "Most of the income comes from royalties from the Firefox search box. Their search partners includes Google, Bing, Yahoo, Yandex, Amazon, eBay and others. Also donations and grants.",
  type: ["browser"],
  sources: ["http://www.extremetech.com/internet/92558-how-browsers-make-money-or-why-google-needs-firefox", "http://www.mozilla.org/en-US/foundation/annualreport/2012/faq/"]
},{
  name: 'craigslist',
  revenues: {
    advertising:1,
    freemium:1,
    subscribers:0,
    premium:0,
    lead_gen:0,
    transactions:1,
    selling_data:0
  },
  revenue: "US$27 million (2013)",
  profitable: true,
  description: "Ads and charging users for posting in selected categories.",
  type: ["webapps"],
  sources: ["http://www.craigslist.org/about/factsheet"]
},{
  name: 'dropbox',
  revenues: {
    advertising:0,
    freemium:1,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:1,
    selling_data:0
  },
  revenue: "US$200 million (2013)",
  profitable: true,
  description: "A fixed capacity for free, to increase it users have to subscribe.",
  type: ["webapp"],
  sources: ["http://techcrunch.com/2013/11/19/if-dropboxs-2013-revenue-is-200m-an-8b-valuation-is-pretty-steep/"]
},{
  name: 'google',
  revenues: {
    advertising:1,
    freemium:0,
    subscribers:0,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  revenue: "US$59.82 billion (2013)",
  profitable: true,
  description: "Ad products is their main source of revenue (AdSense and AdWords)",
  type: ["webapp", "search"],
  sources: ["http://blogoscoped.com/archive/2009-01-07-n84.html", "http://en.wikipedia.org/wiki/Google"]
},{
  name: 'shopify',
  revenues: {
    advertising:0,
    freemium:0,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:1,
    selling_data:0
  },
  revenue: "US$100 million?",
  profitable: true,
  description: "Ad products is their main source of revenue (AdSense and AdWords)",
  type: ["webapp", "search"],
  sources: ["http://signalvnoise.com/posts/2378-profitable-proud-shopify", "http://www.shopify.com/2013", "http://www.theglobeandmail.com/report-on-business/small-business/sb-money/business-funding/a-rare-startup-success-story-shopify-hits-1-billion-milestone/article15892998/"]
},{
  name: 'airbnb',
  revenues: {
    advertising:0,
    freemium:0,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:1,
    selling_data:0
  },
  revenue: "US$1 billion?",
  profitable: true,
  description: "Charge to travelers a fee of 6-12% and hosts pay a 3% for every booking on their site.",
  type: ["webapp", "social-media"],
  sources: ["http://www.theglobeandmail.com/report-on-business/small-business/sb-money/business-funding/a-rare-startup-success-story-shopify-hits-1-billion-milestone/article15892998/", "http://www.businessinsider.com/airbnb-billion-revenues-2013-1"]
},{
  name: 'zynga',
  revenues: {
    advertising:1,
    freemium:1,
    subscribers:0,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  revenue: "US$873.266 million (2013)",
  profitable: true,
  description: "Zynga makes money through people purchasing credits for games and also throught partnerships.",
  type: ["webapp", "games"],
  sources: ["http://www.theglobeandmail.com/report-on-business/small-business/sb-money/business-funding/a-rare-startup-success-story-shopify-hits-1-billion-milestone/article15892998/"]
},{
  name: 'world_of_warcraft',
  revenues: {
    advertising:1,
    freemium:0,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  revenue: "US$93 million (2013)",
  profitable: true,
  description: "Charges $15 per month to users. They also sends expasions packs and discs.",
  type: ["webapp", "games"],
  sources: ["http://www.theglobeandmail.com/report-on-business/small-business/sb-money/business-funding/a-rare-startup-success-story-shopify-hits-1-billion-milestone/article15892998/", "http://www.tomshardware.com/news/microtransactions-world-of-warcraft-revenues-mmorpg-in-game-store,24236.html"]
},{
  name: 'hulu',
  revenues: {
    advertising:1,
    freemium:0,
    subscribers:1,
    premium:0,
    lead_gen:0,
    transactions:0,
    selling_data:0
  },
  revenue: "US$1 billion (2013)",
  profitable: true,
  description: "Free service has Ads, limitations and restrictions, which are removed for subscribed users.",
  type: ["webapp", "streaming"],
  sources: ["http://gigaom.com/2013/12/18/hulu-2013-1-billion-in-revenue-5-million-subscribers-in-2013/"]
}];

$(function(){
  var $container = $('#companies-holder');

  _.each(companies, function printCompanies(company){
    var $company = _.template($("#company-icon").html(), company);
    $container.append($company);

    var $details = _.template($("#company-detail").html(), company);
    $container.append($details);
  });

  $(".company-icon").on('click', function(e){
    e.preventDefault();
    var name = $(this).data('company');
    var $description = $("#company-details-"+name);

    $description.dialog({
      dialogClass: "company-details-modal",
      modal: true,
      hide: { effect: "explode", duration: 300 },
    });
    $(".ui-widget-overlay").on("click", function() {  $(".ui-dialog-content").dialog().dialog("close"); });
  });
});

</script>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/15/cheap-airplay-receiver-with-raspberry-pi/">Cheap Airplay Receiver With Raspberry Pi</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-02-15T13:59:26-04:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>1:59 pm</span></time>
        
           | <a href="/blog/2014/02/15/cheap-airplay-receiver-with-raspberry-pi/#disqus_thread"
             data-disqus-identifier="http://adrianmejia.com/blog/2014/02/15/cheap-airplay-receiver-with-raspberry-pi/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I got excited about the idea of having a Raspberry Pi. It is in essence one of the smallest complete computer that you can get for $35 bucks! Ok, after I got one I had to do something useful with it&hellip; So I make it a Airplay receiver to play music remotely from any of my apple devices!</p>

<p><img src="/images/RaspiModelB.png"></p>

<p>There is a couple of ways to make it work. The easiest one is to install the RaspBMC, a popular media center.(<a href="http://www.raspberrypi.org/downloads">http://www.raspberrypi.org/downloads</a>)
You can even turn it into a home theater (<a href="http://www.makeuseof.com/tag/raspberry-pi-home-theater-system/">http://www.makeuseof.com/tag/raspberry-pi-home-theater-system/</a>).
However, I&rsquo;m not going to explain any of those ways because just installing them gives you 99% of the functionality. As a developer, I want to have control of the computers, and I&rsquo;m not afraid of the console. So, I installed Raspbian instead, which is a lightweight Ubuntu/Debian Linux optimized for Raspberry Pi.</p>

<h1>Getting started</h1>

<p><strong>1. Install Raspbian “wheezy”</strong></p>

<p>Download the image from <a href="http://www.raspberrypi.org/downloads">http://www.raspberrypi.org/downloads</a> and follow the instructions. You have to format the SD card and &ldquo;copy&rdquo; the image. You can download this formatting tool: <a href="https://www.sdcard.org/downloads/formatter_4.">https://www.sdcard.org/downloads/formatter_4.</a> After that, plug the SD card in Raspberry, also the Ethernet cable and power cord. For more instructions follow <a href="http://lifehacker.com/5976912/a-beginners-guide-to-diying-with-the-raspberry-pi" target="_blank"><a href="http://lifehacker.com/5976912/a-beginners-guide-to-diying-with-the-raspberry-pi">http://lifehacker.com/5976912/a-beginners-guide-to-diying-with-the-raspberry-pi</a></a>.</p>

<p><strong>2.  Setup Pi</strong></p>

<p>You need to connect it to an HDMI display to set it up using a USB mouse and keyboard or you can use SSH if you had set that up.</p>

<p><strong>3. Access the Terminal</strong></p>

<p>From the terminal type the following commands in you Raspberry Pi:</p>

<p>Become root and update the system</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo apt-get update <span class="o">&amp;&amp;</span> sudo apt-get upgrade
</span></code></pre></td></tr></table></div></figure>


<p><strong>3. Setup Audio</strong></p>

<p>Audio ports could either be bind to the HDMI connection or to the audio output jack (you need sudo to execute any sound command).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo amixer cset <span class="nv">numid</span><span class="o">=</span><span class="m">3</span> 1
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Connect the speakers to you Raspberry Pi. You can test that they work with these:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo speaker-test -t pink -l 1
</span><span class='line'>sudo speaker-test -t sine -l 1
</span></code></pre></td></tr></table></div></figure>


<p>You can also adjust the volume</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo alsamixer
</span></code></pre></td></tr></table></div></figure>


<p><strong>4. Install Airplay software</strong></p>

<p>I tested with 2 different programs, both of them did the trick for me.</p>

<ul>
<li><a href="https://github.com/juhovh/shairplay">https://github.com/juhovh/shairplay</a></li>
<li><a href="https://github.com/abrasive/shairport">https://github.com/abrasive/shairport</a></li>
</ul>


<p>The latter is more popular so I will give the instructions for that one:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>apt-get install -y libssl-dev libavahi-client-dev libasound2-dev git
</span><span class='line'>git clone https://github.com/abrasive/shairport.git
</span><span class='line'><span class="nb">cd </span>shairport
</span><span class='line'>./configure
</span><span class='line'>make
</span><span class='line'>./shairport -a <span class="s1">&#39;AirPi&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>5. Run Airplay (shairport) on boot.</strong></p>

<p>It&rsquo;s nice to run airport receiver automatically when you connect your Pi.</p>

<p>Create a file to start shairport</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>nano /etc/init.d/airplay
</span></code></pre></td></tr></table></div></figure>


<p>Type the following into <code>airplay</code>:</p>

<figure class='code'><figcaption><span>airplay </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'>/usr/local/bin/shairport -a <span class="s2">&quot;AirPi&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Close the editing mode and exit the file. Then register the script to be run on boot.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>chmod a+x /etc/init.d/airplay
</span><span class='line'>update-rc.d airplay defaults
</span></code></pre></td></tr></table></div></figure>


<p>Reboot your Pi and you are good to go!
(If you have any questions you can write a comment below)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/13/algorithms-for-dummies-part-1-sorting/">Algorithms for Dummies (Part 1): Big-O Notation and Sorting</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-02-13T09:28:51-04:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:28 am</span></time>
        
           | <a href="/blog/2014/02/13/algorithms-for-dummies-part-1-sorting/#disqus_thread"
             data-disqus-identifier="http://adrianmejia.com/blog/2014/02/13/algorithms-for-dummies-part-1-sorting/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After being developing software for a while,  I realized that there is a couple of ways to become better at it. One it&rsquo;s through your experience: writing code, working on projects, getting hands dirty&hellip; Other one it&rsquo;s learning algorithms and design patterns. In other words through leveraging the experience of other computer scientists. Learning to use algorithms efficiently can instantly add to you the equivalent of 10 years of experience or more. Let&rsquo;s get started and add new tools to our arsenal!</p>

<p>How do you know a piece of code that you just wrote is good enough?  When you modify a program, how do you know if it is better as you found it? How do scale programs to handle huge amount of data? In fact, You cannot improve what you can&rsquo;t measure.</p>

<p>How to measure them? We could count the number of seconds it takes to execute and compare it with other one. However, it&rsquo;s not just troublesome to timers around code but if we run it in different hardware (e.g. supercomputer) it will seem like more efficient when indeed it&rsquo;s exactly the same program. Let&rsquo;s illustrate a better way with an example. Let&rsquo;s say you want to sort an array of n integers.</p>

<h1>Sorting Algorithms</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'>  <span class="kt">void</span> <span class="nf">sort</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">arr</span><span class="o">){</span>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">arr</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">x</span><span class="o">++)</span>
</span><span class='line'>      <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">;</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">arr</span><span class="o">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span> <span class="o">&gt;</span> <span class="n">arr</span><span class="o">[</span><span class="n">y</span><span class="o">];</span> <span class="n">y</span><span class="o">--){</span>
</span><span class='line'>          <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="n">y</span><span class="o">];</span>
</span><span class='line'>          <span class="n">arr</span><span class="o">[</span><span class="n">y</span><span class="o">]</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="o">];</span>
</span><span class='line'>          <span class="n">arr</span><span class="o">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">t</span><span class="o">;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Do you recognize this algorithm? It&rsquo;s called Insertion sort. It has two nested loops, which means that as the number of elements n in the array <code>arr</code> grows it will take approximately n * n longer to perform the sorting. In big-O notation, this will be represented like O(n<sup>2</sup>). More on this notation later.</p>

<p>What would happen if the array arr is already sorted? That would be the best-case scenario. The inner for loop will never go through all the elements in the array then (because <code>arr[y-1] &gt; arr[y]</code>  won&rsquo;t be met). So the algorithm in run in O(n).</p>

<p>We are not living in an ideal world. So O(n<sup>2</sup>) will be probably the average time complexity. Can you think a better way of sorting an array of elements?</p>

<p>Take some minutes to think and come back&hellip;</p>

<h2>Merge Sort</h2>

<p>A more efficient algorithm is the Merge sort. It uses the principle of divide and conquer to solve the problem faster. The idea is the follows:</p>

<p><img src="/images/mergesort.gif"></p>

<ul>
<li>Divide the array in half</li>
<li>Divide the halves by half until 2 or 3 elements are remaining</li>
<li>Sort each of these halves</li>
<li>Merge them back together</li>
</ul>


<p>Can you determine the time complexity of mergesort?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'>  <span class="kt">void</span> <span class="nf">sort</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">arr</span><span class="o">){</span>
</span><span class='line'>    <span class="kt">int</span><span class="o">[]</span> <span class="n">helper</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">arr</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
</span><span class='line'>    <span class="n">mergesort</span><span class="o">(</span><span class="n">arr</span><span class="o">,</span> <span class="n">helper</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">arr</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kt">void</span> <span class="nf">mergesort</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">arr</span><span class="o">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">helper</span><span class="o">,</span> <span class="kt">int</span> <span class="n">low</span><span class="o">,</span> <span class="kt">int</span> <span class="n">high</span><span class="o">){</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="o">){</span>
</span><span class='line'>      <span class="kt">int</span> <span class="n">middle</span> <span class="o">=</span> <span class="o">(</span><span class="n">high</span><span class="o">+</span><span class="n">low</span><span class="o">)/</span><span class="mi">2</span><span class="o">;</span>
</span><span class='line'>      <span class="n">mergesort</span><span class="o">(</span><span class="n">arr</span><span class="o">,</span> <span class="n">helper</span><span class="o">,</span> <span class="n">low</span><span class="o">,</span> <span class="n">middle</span><span class="o">);</span>
</span><span class='line'>      <span class="n">mergesort</span><span class="o">(</span><span class="n">arr</span><span class="o">,</span> <span class="n">helper</span><span class="o">,</span> <span class="n">middle</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">high</span><span class="o">);</span>
</span><span class='line'>      <span class="n">merge</span><span class="o">(</span><span class="n">arr</span><span class="o">,</span> <span class="n">helper</span><span class="o">,</span> <span class="n">low</span><span class="o">,</span> <span class="n">middle</span><span class="o">,</span> <span class="n">high</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kt">void</span> <span class="nf">merge</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">arr</span><span class="o">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">helper</span><span class="o">,</span> <span class="kt">int</span> <span class="n">low</span><span class="o">,</span> <span class="kt">int</span> <span class="n">middle</span><span class="o">,</span> <span class="kt">int</span> <span class="n">high</span><span class="o">){</span>
</span><span class='line'>    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">low</span><span class="o">;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">high</span><span class="o">;</span> <span class="n">x</span><span class="o">++)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">helper</span><span class="o">[</span><span class="n">x</span><span class="o">]</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="n">x</span><span class="o">];</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kt">int</span> <span class="n">left</span> <span class="o">=</span> <span class="n">low</span><span class="o">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">curr</span> <span class="o">=</span> <span class="n">low</span><span class="o">;</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">right</span> <span class="o">=</span> <span class="n">middle</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">while</span><span class="o">(</span><span class="n">left</span> <span class="o">&lt;=</span> <span class="n">middle</span> <span class="o">&amp;&amp;</span> <span class="n">right</span> <span class="o">&lt;=</span> <span class="n">high</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">if</span><span class="o">(</span><span class="n">helper</span><span class="o">[</span><span class="n">right</span><span class="o">]</span> <span class="o">&gt;</span> <span class="n">helper</span><span class="o">[</span><span class="n">left</span><span class="o">])</span>
</span><span class='line'>        <span class="n">arr</span><span class="o">[</span><span class="n">curr</span><span class="o">++]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">[</span><span class="n">left</span><span class="o">++];</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="n">arr</span><span class="o">[</span><span class="n">curr</span><span class="o">++]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">[</span><span class="n">right</span><span class="o">++];</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">while</span><span class="o">(</span><span class="n">left</span> <span class="o">&lt;=</span> <span class="n">middle</span><span class="o">)</span>
</span><span class='line'>      <span class="n">arr</span><span class="o">[</span><span class="n">curr</span><span class="o">++]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">[</span><span class="n">left</span><span class="o">++];</span>
</span><span class='line'>  <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Even though the code is much longer, the algorithm is much more efficient.</p>

<p><img src="/images/insertion_vs_mergsort.png"></p>

<p>It would take some more knowledge to derive the running time mathematically, and we haven&rsquo;t covered that yet. However, bear with me, it&rsquo;s O(n log(n)). Let&rsquo;s sum up:</p>

<table>
<thead>
<tr>
<th>Algorithm </th>
<th> best </th>
<th> average </th>
<th> worst </th>
<th> space complexity</th>
</tr>
</thead>
<tbody>
<tr>
<td>Insertion Sort </td>
<td> O(n) </td>
<td> O(n<sup>2</sup>) </td>
<td> O(n<sup>2</sup>) </td>
<td> O(1)</td>
</tr>
<tr>
<td>Merge sort </td>
<td> O(n log(n)) </td>
<td> O(n log(n)) </td>
<td> O(n log(n)) </td>
<td> O(n)</td>
</tr>
</tbody>
</table>


<p>Notice that the table has also the space complexity. How much space does the algorithms take is also an important parameter to compare algorithms. The merge sort uses an additional array that&rsquo;s way its space complexity is <code>O(n)</code>, however, the insertion sort uses <code>O(1)</code> because it does the sorting in-place.</p>

<p>Big O Notation</p>

<p>Big O is defined as the asymptotic upper limit of a function. In plain english, it means that is a function that cover the maximum values a function could take. As we saw a little earlier this notation help us to predict performance and compare algorithms.</p>

<table border=1>
<tr><th>Growth Rate</th><th>Name</th></tr>
<tr><td>1</td><td>Constant</td></tr>
<tr><td>log(n)</td><td>Logarithmic</td></tr>
<tr><td>n</td><td>Linear</td></tr>
<tr><td>n*log(n)</td><td>Linearithmic</td></tr>
<tr><td>n^2</td><td>Quadratic</td></tr>
<tr><td>n^3</td><td>Cubic</td></tr>
<tr><td>2^n</td><td>Exponential</td></tr>
</table>


<p>This is kinda abstract let&rsquo;s see what it means in code:</p>

<table border=1>
<tr><td>Growth Rate</td><td>Name</td><td>Code e.g.</td><td>description</td></tr>
<tr><td>1</td><td>Constant</td><td>a+=1;</td><td>statement (one line of code)</td></tr>
<tr><td>log(n)</td><td>Logarithmic</td><td>
<pre>
while(n>1){
  n=n/2;
}
</pre>
</td><td>Divide in half (binary search)</td></tr>
<tr><td>n</td><td>Linear</td><td>
<pre>
for(c=0; c&lt;n; c++){
  a+=1;
}
</pre></td><td>Loop</td></tr>
<tr><td>n*log(n)</td><td>Linearithmic</td><td>Mergesort, Quicksort, &#8230;</td><td>Effective sorting algorithms</td></tr>
<tr><td>n^2</td><td>Quadratic</td><td>
<pre>
for(c=0; c&lt;n; c++){
  for(i=0; i&lt;n; i++){
    a+=1;
  }
}
</pre>
</td><td>Double loop</td></tr>
<tr><td>n^3</td><td>Cubic</td><td>
<pre>
for(c=0; c&lt;n; c++){
  for(i=0; i&lt;n; i++){
    for(x=0; x&lt;n; x++){
      a+=1;
    }
  }
}
</pre>
</td><td>Triple loop</td></tr>
<tr><td>2^n</td><td>Exponential</td><td>Trying to braeak a password generating all possible combinations</td><td>Exhaustive search</td></tr>
</table>


<p>That&rsquo;s all for this first part 1. I will continue publishing this tutorials every week or so. Stay tune!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/13/backbone-js-for-absolute-beginners-getting-started-part-4/">Backbone.js for Absolute Beginners - Getting Started (Part 4: Routers)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-09-13T14:41:00-04:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>2:41 pm</span></time>
        
           | <a href="/blog/2012/09/13/backbone-js-for-absolute-beginners-getting-started-part-4/#disqus_thread"
             data-disqus-identifier="http://adrianmejia.com/blog/2012/09/13/backbone-js-for-absolute-beginners-getting-started-part-4/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The part 3 of this tutorial is <a href="/blog/2012/09/13/backbonejs-for-absolute-beginners-getting-started-part-3/">here</a>.</p>

<h2>2.6 Backbone.Router</h2>

<p>You could build web application without using the routers.  However, if you want to make reference to certain ‘state’ or location of the web application, you need a reference (link/URL) to it. This is where routers come to rescue.</p>

<p>Routing in most of JS application are achieved by hash-tags. E.g. If you take a look of Gmail URL you will see something like:</p>

<p><code>https://mail.google.com/mail/u/0/#inbox/139c0d48e11d986b</code></p>

<p>where the <code>#inbox/139c0d48e11d986b</code> is the hash-tag which reference some email location.</p>

<p>In backbone, routes are hash maps that match URL patterns to functions. You can use parameter parts, such as <code>todos/:id</code>, or using splats <code>file/*path</code> you will match all the parameters from the splat on. For that reason, the splat parameter should be always the last matcher.</p>

<h3>2.6.1 Initializing the Router</h3>

<p>In our Todo app, we are going to use routers to filter between the tasks that are pending and the ones that have been completed. So, let&rsquo;s initialize the routes this way:</p>

<figure class='code'><figcaption><span>Define Router</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/327ac4fc4657e73fdf7157e230b1ed7cd1519667/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">app</span><span class="p">.</span><span class="nx">Router</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">routes</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s1">&#39;*filter&#39;</span> <span class="o">:</span> <span class="s1">&#39;setFilter&#39;</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">setFilter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;app.router.params = &#39;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">);</span> <span class="c1">// just for didactical purposes.</span>
</span><span class='line'>        <span class="nb">window</span><span class="p">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>        <span class="nx">app</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;reset&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, you need to initialize it, adding this lines:</p>

<figure class='code'><figcaption><span>Initialize router</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/327ac4fc4657e73fdf7157e230b1ed7cd1519667/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'>     //--------------
</span><span class='line'>     // Initializers
</span><span class='line'>     //--------------
</span><span class='line'>
</span><span class='line'><span class="gi">+    app.router = new app.Router();</span>
</span><span class='line'><span class="gi">+    Backbone.history.start();    </span>
</span><span class='line'>     app.appView = new app.AppView();
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>You can test that you router is working just typing <code>#anything/that/you/want</code> and seeing the parameter in you browser&rsquo;s console.</p>

<h3>2.6.1 Processing the routes</h3>

<p>Before rendering the list of items, you need to check the parameters to wether show only the pending ones, or the completed or show them all. As shown in the code snipet below.</p>

<figure class='code'><figcaption><span>Processing the routes in app.AppView</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/327ac4fc4657e73fdf7157e230b1ed7cd1519667/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gu">@@ -164,7 +177,18 @@</span>
</span><span class='line'>       },
</span><span class='line'>       addAll: function(){
</span><span class='line'>         this.$(&#39;#todo-list&#39;).html(&#39;&#39;); // clean the todo list
</span><span class='line'><span class="gd">-        app.todoList.each(this.addOne, this);</span>
</span><span class='line'><span class="gi">+        // filter todo item list</span>
</span><span class='line'><span class="gi">+        switch(window.filter){</span>
</span><span class='line'><span class="gi">+          case &#39;pending&#39;:</span>
</span><span class='line'><span class="gi">+            _.each(app.todoList.remaining(), this.addOne);</span>
</span><span class='line'><span class="gi">+            break;</span>
</span><span class='line'><span class="gi">+          case &#39;completed&#39;:</span>
</span><span class='line'><span class="gi">+            _.each(app.todoList.completed(), this.addOne);</span>
</span><span class='line'><span class="gi">+            break;            </span>
</span><span class='line'><span class="gi">+          default:</span>
</span><span class='line'><span class="gi">+            app.todoList.each(this.addOne, this);</span>
</span><span class='line'><span class="gi">+            break;</span>
</span><span class='line'><span class="gi">+        }</span>
</span><span class='line'>       },
</span><span class='line'>       newAttributes: function(){
</span><span class='line'>         return {
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>If you try adding the words <code>#/pending</code> or <code>#/completed</code> at the end of the URL you&rsquo;ll get an error!. That&rsquo;s a good sign, it means the routes are working, but we haven&rsquo;t implemented the <code>app.todoList.remaining()</code> and <code>app.todoList.completed()</code>. So, that&rsquo;s next:</p>

<figure class='code'><figcaption><span>Defining &#8216;completed&#8217; and &#8216;remaining&#8217; functions in app.TodoList</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/327ac4fc4657e73fdf7157e230b1ed7cd1519667/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gu">@@ -85,7 +90,15 @@</span>
</span><span class='line'>     //--------------
</span><span class='line'>     app.TodoList = Backbone.Collection.extend({
</span><span class='line'>       model: app.Todo,
</span><span class='line'><span class="gd">-      localStorage: new Store(&quot;backbone-todo&quot;)</span>
</span><span class='line'><span class="gi">+      localStorage: new Store(&quot;backbone-todo&quot;),</span>
</span><span class='line'><span class="gi">+      completed: function() {</span>
</span><span class='line'><span class="gi">+        return this.filter(function( todo ) {</span>
</span><span class='line'><span class="gi">+          return todo.get(&#39;completed&#39;);</span>
</span><span class='line'><span class="gi">+        });</span>
</span><span class='line'><span class="gi">+      },</span>
</span><span class='line'><span class="gi">+      remaining: function() {</span>
</span><span class='line'><span class="gi">+        return this.without.apply( this, this.completed() );</span>
</span><span class='line'><span class="gi">+      }      </span>
</span><span class='line'>     });
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Now, if you try again adding the hash-tags it will work! But, it will be better if the user can have links to that instead of typing URLs. So, let&rsquo;s add them.</p>

<figure class='code'><figcaption><span>Show routes&#8217; links</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/327ac4fc4657e73fdf7157e230b1ed7cd1519667/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gu">@@ -32,6 +32,11 @@</span>
</span><span class='line'>     &lt;header id=&quot;header&quot;&gt;
</span><span class='line'>       &lt;h1&gt;Todos&lt;/h1&gt;
</span><span class='line'>       &lt;input id=&quot;new-todo&quot; placeholder=&quot;What needs to be done?&quot; autofocus&gt;
</span><span class='line'><span class="gi">+      &lt;div&gt;</span>
</span><span class='line'><span class="gi">+        &lt;a href=&quot;#/&quot;&gt;show all&lt;/a&gt; |</span>
</span><span class='line'><span class="gi">+        &lt;a href=&quot;#/pending&quot;&gt;show pending&lt;/a&gt; |</span>
</span><span class='line'><span class="gi">+        &lt;a href=&quot;#/completed&quot;&gt;show completed&lt;/a&gt;</span>
</span><span class='line'><span class="gi">+      &lt;/div&gt;      </span>
</span><span class='line'>     &lt;/header&gt;
</span><span class='line'>     &lt;section id=&quot;main&quot;&gt;
</span><span class='line'>       &lt;ul id=&quot;todo-list&quot;&gt;&lt;/ul&gt;
</span></code></pre></td></tr></table></div></figure>


<p>Well, that&rsquo;s all! If completed these 4 parts tutorial you will be familiar with the main Backbone modules (Models, Collections, Views, Events, and Routes). To increase you knowledge you can follow the following resources:</p>

<ul>
<li><a href="https://github.com/documentcloud/backbone/blob/master/backbone.js">Backbone&rsquo;s Source code - it&rsquo;s the ultimate source of true</a></li>
<li><a href="http://backbonejs.org/?utm_source=adrianmejia.com">Official documentation</a></li>
</ul>


<p>Hope it was helpful!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/13/backbonejs-for-absolute-beginners-getting-started-part-3/">Backbone.js for Absolute Beginners - Getting Started (Part 3: CRUD)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-09-13T01:37:00-04:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>1:37 am</span></time>
        
           | <a href="/blog/2012/09/13/backbonejs-for-absolute-beginners-getting-started-part-3/#disqus_thread"
             data-disqus-identifier="http://adrianmejia.com/blog/2012/09/13/backbonejs-for-absolute-beginners-getting-started-part-3/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The part 2 of this tutorial is <a href="/blog/2012/09/13/backbone-js-for-absolute-beginners-getting-started-part-2/">here</a>.</p>

<h2>2.5 Todo item list CRUD</h2>

<p>There are a couple of features that we could improve. Let’s implement the CRUD (Create-Read-Update-Delete) for the item list.</p>

<h3>2.5.1. C-reate</h3>

<p>We are already can create item list from the console (2.3) and also from the UI (2.4.3). So, it’s done.</p>

<h3>2.5.2. U-pdate</h3>

<p>What if you make a mistake and want to change the text on some of your to-do list. Furthermore, you can notice that the checkboxes states are not persistent when you reload the pages. Let’s fix both problems.</p>

<p>1.- You want to respond to a double click event showing up a text box, where the user can change the text. First, let’s add the HTML in the <code>item-template</code> template below the label tag.</p>

<p><code>&lt;input class="edit" value="&lt;%- title %&gt;"&gt;</code></p>

<p>2.- If you refresh, you will notice that there are both displaying at the same time. So, you can hide them properly with the following CSS.</p>

<figure class='code'><figcaption><span>CSS</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/3840dc802d6f311528298639150a5f52364c1975/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'>    <span class="nf">#todo-list</span> <span class="nt">input</span><span class="nc">.edit</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">display</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span> <span class="c">/* Hides input box*/</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="nf">#todo-list</span> <span class="nc">.editing</span> <span class="nt">label</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">display</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span> <span class="c">/* Hides label text when .editing*/</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="nf">#todo-list</span> <span class="nc">.editing</span> <span class="nt">input</span><span class="nc">.edit</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">display</span><span class="o">:</span> <span class="k">inline</span><span class="p">;</span> <span class="c">/* Shows input text box when .editing*/</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>3.- Then, we need to add the events to the TodoView class to respond to the changes.</p>

<figure class='code'><figcaption><span>Todo Model</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/3840dc802d6f311528298639150a5f52364c1975/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="c1">// renders individual todo items list (li)</span>
</span><span class='line'>    <span class="nx">app</span><span class="p">.</span><span class="nx">TodoView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">tagName</span><span class="o">:</span> <span class="s1">&#39;li&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">template</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#item-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()),</span>
</span><span class='line'>      <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()));</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.edit&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// enable chained calls</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s1">&#39;dblclick label&#39;</span> <span class="o">:</span> <span class="s1">&#39;edit&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s1">&#39;keypress .edit&#39;</span> <span class="o">:</span> <span class="s1">&#39;updateOnEnter&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s1">&#39;blur .edit&#39;</span> <span class="o">:</span> <span class="s1">&#39;close&#39;</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">edit</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;editing&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">close</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">().</span><span class="nx">trim</span><span class="p">();</span>
</span><span class='line'>        <span class="k">if</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="nx">title</span><span class="o">:</span> <span class="nx">value</span><span class="p">});</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;editing&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">updateOnEnter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>        <span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="o">==</span> <span class="mi">13</span><span class="p">){</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>       <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can find the <a href="https://github.com/amejiarosario/Backbone-tutorial/commit/3840dc802d6f311528298639150a5f52364c1975">diff</a> that were added to implement the update feature.</p>

<p><a href="https://github.com/amejiarosario/Backbone-tutorial/commit/19fa69e654ae5d370385675e4ffed615532b9934">Here</a> are the changes to fix the update for the checkboxes.</p>

<h3>2.5.2. D-elete</h3>

<p>To be able to remove to-do items, we need to add a remove button in each item and listen to the click event on it, which will trigger the destroy function in the selected todo object.</p>

<p>1.- Add the HTML markup for the remove button.</p>

<figure class='code'><figcaption><span>Remove Button into &#8216;item template&#8217;</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/1267e531ae3ef508eb32e5308c2cc965f02d1b45/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gu">@@ -47,6 +47,7 @@</span>
</span><span class='line'>       &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot; &lt;%= completed ? &#39;checked&#39; : &#39;&#39; %&gt;&gt;
</span><span class='line'>       &lt;label&gt;&lt;%- title %&gt;&lt;/label&gt;
</span><span class='line'>       &lt;input class=&quot;edit&quot; value=&quot;&lt;%- title %&gt;&quot;&gt;
</span><span class='line'><span class="gi">+      &lt;button class=&quot;destroy&quot;&gt;remove&lt;/button&gt;</span>
</span><span class='line'>     &lt;/div&gt;
</span><span class='line'>   &lt;/script&gt;
</span></code></pre></td></tr></table></div></figure>


<p>2.- Listen for the click event in the button that you just created.</p>

<figure class='code'><figcaption><span>Add event listeners for the Remove Button in &#8216;app.TodoView&#8217;</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/1267e531ae3ef508eb32e5308c2cc965f02d1b45/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gu">@@ -105,12 +106,14 @@</span>
</span><span class='line'>       },
</span><span class='line'>       initialize: function(){
</span><span class='line'>         this.model.on(&#39;change&#39;, this.render, this);
</span><span class='line'><span class="gi">+        this.model.on(&#39;destroy&#39;, this.remove, this); // remove: Convenience Backbone&#39;</span>
</span><span class='line'>       },
</span><span class='line'>       events: {
</span><span class='line'>         &#39;dblclick label&#39; : &#39;edit&#39;,
</span><span class='line'>         &#39;keypress .edit&#39; : &#39;updateOnEnter&#39;,
</span><span class='line'>         &#39;blur .edit&#39; : &#39;close&#39;,
</span><span class='line'><span class="gd">-        &#39;click .toggle&#39;: &#39;toggleCompleted&#39;</span>
</span><span class='line'><span class="gi">+        &#39;click .toggle&#39;: &#39;toggleCompleted&#39;,</span>
</span><span class='line'><span class="gi">+        &#39;click .destroy&#39;: &#39;destroy&#39;</span>
</span><span class='line'>       },
</span><span class='line'>       edit: function(){
</span><span class='line'>         this.$el.addClass(&#39;editing&#39;);
</span></code></pre></td></tr></table></div></figure>


<p>3.- Add the destroy method to the TodoView.</p>

<figure class='code'><figcaption><span>Add the destroy method to &#8216;app.TodoView&#8217;</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/1267e531ae3ef508eb32e5308c2cc965f02d1b45/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'><span class="gu">@@ -130,7 +133,10 @@</span>
</span><span class='line'>       },
</span><span class='line'>       toggleCompleted: function(){
</span><span class='line'>         this.model.toggle();
</span><span class='line'><span class="gd">-      }</span>
</span><span class='line'><span class="gi">+      },</span>
</span><span class='line'><span class="gi">+      destroy: function(){</span>
</span><span class='line'><span class="gi">+        this.model.destroy();</span>
</span><span class='line'><span class="gi">+      }      </span>
</span><span class='line'>     });
</span></code></pre></td></tr></table></div></figure>


<p>You can download the full working code so far in <a href="https://raw.github.com/amejiarosario/Backbone-tutorial/1267e531ae3ef508eb32e5308c2cc965f02d1b45/backbone-tutorial.html">here</a> and you can visualize the changes needed to implement the delete feature in <a href="https://github.com/amejiarosario/Backbone-tutorial/commit/1267e531ae3ef508eb32e5308c2cc965f02d1b45">here</a></p>

<h3>Continue with the <a href="/blog/2012/09/13/backbone-js-for-absolute-beginners-getting-started-part-4/">4th part</a> and learn about Backbone&rsquo;s Routes!</h3>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/13/backbone-js-for-absolute-beginners-getting-started-part-2/">Backbone.js for Absolute Beginners - Getting Started (Part 2: Models, Collections and Views)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-09-13T00:08:00-04:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:08 am</span></time>
        
           | <a href="/blog/2012/09/13/backbone-js-for-absolute-beginners-getting-started-part-2/#disqus_thread"
             data-disqus-identifier="http://adrianmejia.com/blog/2012/09/13/backbone-js-for-absolute-beginners-getting-started-part-2/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The part 1 of this tutorial is <a href="/blog/2012/09/11/backbone-dot-js-for-absolute-beginners-getting-started/">here</a></p>

<h2>2. Todo App in Backbone (Models, Collections, View and Events)</h2>

<p>After completing this example app, you will have experience and basic understanding of all the modules of Backbone!</p>

<p>(Updated: 2013-02-02, 2013-11-24)
Notice: This tutorial was written using Backbone v.0.9.x, now version 1.1.x or later are out. However, all the principles exaplained here applies for both.</p>

<h3>2.1.- Todo app Boiler plate</h3>

<p>Let&rsquo;s start again with the initial <a href="https://raw.github.com/amejiarosario/Backbone-tutorial/439ff34409dfc01adca7f9f96efcd726295f1aac/backbone-tutorial.html">HTML file</a> used on 1.1. Now, instead of div#container let&rsquo;s add the following HTML code:</p>

<figure class='code'><figcaption><span>HTML Structure</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/fe0efb0fd0c4c3c4cb5fd61e9917165082f9a562/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>  <span class="nt">&lt;section</span> <span class="na">id=</span><span class="s">&quot;todoapp&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;header</span> <span class="na">id=</span><span class="s">&quot;header&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;h1&gt;</span>Todos<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>      <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;new-todo&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;What needs to be done?&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/header&gt;</span>
</span><span class='line'>    <span class="nt">&lt;section</span> <span class="na">id=</span><span class="s">&quot;main&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;todo-list&quot;</span><span class="nt">&gt;&lt;/ul&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/section&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/section&gt;</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>We are going to implement a To-do list, which is basically un-ordered list (ul) of elements with checkboxes.</p>

<h3>2.2.- Backbone.Model</h3>

<p>Models are the heart of every application. It contains the interactive data and the logic surrounding it, such as data validation, getters and setters, default values, data initialization, conversions and so on.
For our example, we are going to create a model called <code>Todo</code>, which will store a string of text (title) and whether the task has been completed or not.</p>

<figure class='code'><figcaption><span>Todo Model</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/fe0efb0fd0c4c3c4cb5fd61e9917165082f9a562/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="p">{};</span> <span class="c1">// create namespace for our app</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">app</span><span class="p">.</span><span class="nx">Todo</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">defaults</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">completed</span><span class="o">:</span> <span class="kc">false</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice, that for convention classes names are capitalize, while instance variables and objects are not. Another important aspect of models it’s that their properties are dynamic; they can be created on the fly and doesn’t have any specific type associated.</p>

<p><strong>Test what you just coded!</strong></p>

<p>After you completed the code snippet above you can open your browser console (chrome&rsquo;s console: ctrl+shift+i -or- ⌘+alt+i) and try this out, to get familiar with the models:</p>

<figure class='code'><figcaption><span>Practice in your Browser&#39;s console </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">todo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Todo</span><span class="p">({</span><span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Learn Backbone.js&#39;</span><span class="p">,</span> <span class="nx">completed</span><span class="o">:</span> <span class="kc">false</span><span class="p">});</span> <span class="c1">// create object with the attributes specified.</span>
</span><span class='line'><span class="nx">todo</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span> <span class="c1">// &quot;Learn Backbone.js&quot; </span>
</span><span class='line'><span class="nx">todo</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;completed&#39;</span><span class="p">);</span> <span class="c1">// false</span>
</span><span class='line'><span class="nx">todo</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;created_at&#39;</span><span class="p">);</span> <span class="c1">// undefined</span>
</span><span class='line'><span class="nx">todo</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="nb">Date</span><span class="p">());</span>
</span><span class='line'><span class="nx">todo</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;created_at&#39;</span><span class="p">);</span> <span class="c1">// &quot;Wed Sep 12 2012 12:51:17 GMT-0400 (EDT)&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>2.3.- Backbone.Collection</h3>

<p>As its name indicates, collections are ordered sets of models, where you can get and set models in the collection, listen for events when any element in the collection changes, and fetching for model’s data from the server.</p>

<p>E.g.: <code>todoList.fetch();</code></p>

<p>Collections allows to save data (in database, file, memory), and it requires a reference to it. Therefore, you need to specify the <code>url</code> parameter with a relative url, where the model’s resource would be located on the server. Otherwise, you will get errors like:</p>

<p><code>A "url" property or function must be specified</code></p>

<p>We are not going to use a backend server for simplicity (I will do a new post for that); instead we are going to use HTML5’s local storage for persistence through a Backbone’s plugin. So, we need to define the localStorage property instead of URL. You need to include the backbone-localstorage.js with the rest of your libs as <a href="https://raw.github.com/amejiarosario/Backbone-tutorial/fe0efb0fd0c4c3c4cb5fd61e9917165082f9a562/backbone-tutorial.html">shown in the full code</a>:</p>

<p><code>&lt;script src="http://cdnjs.cloudflare.com/ajax/libs/backbone-localstorage.js/1.0/backbone.localStorage-min.js" type="text/javascript"&gt;</code></p>

<figure class='code'><figcaption><span>Todo list Collection</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/fe0efb0fd0c4c3c4cb5fd61e9917165082f9a562/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">app</span><span class="p">.</span><span class="nx">TodoList</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collection</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">model</span><span class="o">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Todo</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">localStorage</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Store</span><span class="p">(</span><span class="s2">&quot;backbone-todo&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// instance of the Collection</span>
</span><span class='line'>    <span class="nx">app</span><span class="p">.</span><span class="nx">todoList</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">app</span><span class="p">.</span><span class="nx">TodoList</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Test what you just your coded!</strong></p>

<p>(Google&rsquo;s Chrome console shortcuts: ctrl+shift+i -or- ⌘+alt+i)</p>

<figure class='code'><figcaption><span>Practice in your Browser&#39;s console </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">todoList</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">app</span><span class="p">.</span><span class="nx">TodoList</span><span class="p">()</span>
</span><span class='line'><span class="nx">todoList</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Learn Backbone\&#39;s Collection&#39;</span><span class="p">});</span> <span class="c1">// notice: that `completed` will be set to false by default.</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">lmodel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Todo</span><span class="p">({</span><span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Learn Models&#39;</span><span class="p">,</span> <span class="nx">completed</span><span class="o">:</span> <span class="kc">true</span><span class="p">});</span>
</span><span class='line'><span class="nx">todoList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">lmodel</span><span class="p">);</span>
</span><span class='line'><span class="nx">todoList</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>     <span class="c1">// [&quot;Learn Backbone&#39;s Collection&quot;, &quot;Learn Models&quot;]</span>
</span><span class='line'><span class="nx">todoList</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="s1">&#39;completed&#39;</span><span class="p">);</span> <span class="c1">// [false, true]</span>
</span><span class='line'><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">todoList</span><span class="p">);</span>    <span class="c1">// &quot;[{&quot;title&quot;:&quot;Learn Backbone&#39;s Collection&quot;,&quot;completed&quot;:false,&quot;id&quot;:&quot;d9763e99-2267-75f5-62c3-9d7e40742aa6&quot;},{&quot;title&quot;:&quot;Learn Models&quot;,&quot;completed&quot;:true}]&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>2.4.- Backbone.View</h2>

<p>As mentioned in <a href="/blog/2012/09/11/backbone-dot-js-for-absolute-beginners-getting-started/#1.2">1.2</a>, Views doesn’t have the HTML markups for our application, but instead (It&rsquo;s like the controller in MVC frameworks) process data and link it to templates and it finally render HTML based on events or data changes.</p>

<h3>2.4.1.- Basic Properties</h3>

<p>There are 4 basic properties in a view: el, initialize, render, and events.</p>

<p>We have already seen the first 3 and will see later the fourth one. Do you remember the Hello World View from <a href="/blog/2012/09/11/backbone-dot-js-for-absolute-beginners-getting-started/#1.2">1.2</a>?</p>

<figure class='code'><figcaption><span>Example of a Backbone.View </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="kd">var</span> <span class="nx">AppView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>      <span class="c1">// el - stands for element. Every view has a element associate in with HTML </span>
</span><span class='line'>      <span class="c1">//      content will be rendered.</span>
</span><span class='line'>      <span class="nx">el</span><span class="o">:</span> <span class="s1">&#39;#container&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="c1">// It&#39;s the first function called when this view it&#39;s instantiated.</span>
</span><span class='line'>      <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="c1">// $el - it&#39;s a cached jQuery object (el), in which you can use jQuery functions </span>
</span><span class='line'>      <span class="c1">//       to push content. Like the Hello World in this case.</span>
</span><span class='line'>      <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>2.4.1.1.- <code>view.el</code></h3>

<p>Every view needs to reference a DOM at all times. Therefore, the view will inject content into this element. This is the <code>el</code> property. <code>this.el</code> is created from view’s <code>el</code>,<code>tagName</code>, <code>className</code>, <code>id</code> or <code>attributes</code> properties. If none of these are specified, then this.el is an empty <code>div</code>. The <code>view.$el</code> it’s a cached jQuery object of the view’s element (view.el).</p>

<h3>2.4.1.2.- Initialize/construtor</h3>

<p>Here you have the option to pass parameters that will be attached to a model, collection or view.el.</p>

<h3>2.4.1.3.- <code>render</code></h3>

<p>This function injects the markup into the elements. Not all views require having a render function, as you are going to see in the sample code, they can call other view’s render functions.</p>

<h3>2.4.1.5.- delegated events</h3>

<p>Events are written in the following format:</p>

<p><code>{"&lt;EVENT_TYPE&gt; &lt;ELEMENT_ID&gt;": "&lt;CALLBACK_FUNTION&gt;"}</code></p>

<p>E.g.</p>

<p><code>events: {'keypress #new-todo': 'createTodoOnEnter'}</code></p>

<p>in jQuery it would be something like:</p>

<p><code>$('#new-todo').keypress(createTodoOnEnter);</code></p>

<h2>2.4.2.- Todo View</h2>

<p>Now back to our To-do application: We need a view that renders each of the todo model objects into the page. The <code>item-template</code> and <code>app.TodoView</code> will render each todo item.</p>

<figure class='code'><figcaption><span>item-template</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/fe0efb0fd0c4c3c4cb5fd61e9917165082f9a562/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>   <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/template&quot;</span> <span class="na">id=</span><span class="s">&quot;item-template&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;view&quot;</span><span class="o">&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">input</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;toggle&quot;</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span><span class="o">&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;&lt;%-</span> <span class="nx">title</span> <span class="o">%&gt;&lt;</span><span class="err">/label&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the following block of code we have the Backbone.View which uses the above template (<code>#item-template</code>) to fill it out the title from the <code>model</code> we pass along.</p>

<figure class='code'><figcaption><span>Todo View</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/fe0efb0fd0c4c3c4cb5fd61e9917165082f9a562/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="c1">// renders individual todo items list (li)</span>
</span><span class='line'>    <span class="nx">app</span><span class="p">.</span><span class="nx">TodoView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">tagName</span><span class="o">:</span> <span class="s1">&#39;li&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">template</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#item-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()),</span>
</span><span class='line'>      <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()));</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// enable chained calls</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>When we instanciate the views, they can receive any parameter that we need. In our case we call it <code>model</code> so we need to instanciated with a model (e.g. todo):</p>

<p><code>var view = new app.TodoView({model: todo});</code></p>

<p>Also notice that it&rsquo;s using a <code>tagName: li</code> instead of the just <code>el</code> from before. This mean that the new render elements will be wrapped around a <code>&lt;li&gt;&lt;/li&gt;</code></p>

<h2>2.5.- Backbone.Events</h2>

<p>This module can be mixed with any object and give it the pub/sub (observer patter) behaviour. Events provides a couple of methods from which we are going to discuss: <code>on</code>, <code>off</code> and <code>trigger</code>. (If this you are familiar with then in jQuery, they will work the same way + some nice built-in features)</p>

<h3>2.5.1 on</h3>

<p><code>object.on(event, callback, [context])</code></p>

<p>Also called bind. It binds an object to an event and a callback. When that event it&rsquo;s triggered it executes the callback.</p>

<p>E.g.
<code>todoList.on('add', this.addAll, this);</code></p>

<p>Everytime a new item is <code>add</code>ed to a Backbone.Collection the event <code>add</code> is triggered. In the example above, after the event is triggered the todoList&rsquo;s callback <code>addAll()</code> is executed and the current object is passed with <code>this</code> as a <code>context</code>.</p>

<p>Events can also be set on arbitrary objects using underscore.js <code>extend</code> function:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">object</span> <span class="o">=</span> <span class="p">{},</span>
</span><span class='line'>    <span class="nx">callback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Triggered &quot;</span> <span class="o">+</span> <span class="nx">msg</span><span class="p">);</span> <span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">object</span><span class="p">,</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Events</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">object</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;my_event&quot;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">object</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;my_event&quot;</span><span class="p">,</span> <span class="s2">&quot;my custom event&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>App View</h2>

<p>Now, we need another view that take a collection and render each of the individual items. We are going to call it ‘AppView’. Take a look through this code and try to identify each of the elements (we have already describe them in the previous sections).</p>

<figure class='code'><figcaption><span>Todo View</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/fe0efb0fd0c4c3c4cb5fd61e9917165082f9a562/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="c1">// renders the full list of todo items calling TodoView for each one.</span>
</span><span class='line'>    <span class="nx">app</span><span class="p">.</span><span class="nx">AppView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">el</span><span class="o">:</span> <span class="s1">&#39;#todoapp&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#new-todo&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="c1">// when new elements are added to the collection render then with addOne</span>
</span><span class='line'>        <span class="nx">app</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">addOne</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">app</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;reset&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">addAll</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">app</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">fetch</span><span class="p">();</span> <span class="c1">// Loads list from local storage</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s1">&#39;keypress #new-todo&#39;</span><span class="o">:</span> <span class="s1">&#39;createTodoOnEnter&#39;</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">createTodoOnEnter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span> <span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="o">!==</span> <span class="mi">13</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">().</span><span class="nx">trim</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span> <span class="c1">// ENTER_KEY = 13</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="nx">app</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">newAttributes</span><span class="p">());</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="c1">// clean input box</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">addOne</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">app</span><span class="p">.</span><span class="nx">TodoView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span> <span class="nx">todo</span><span class="p">});</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#todo-list&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span><span class="p">);</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">addAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#todo-list&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="c1">// clean the todo list</span>
</span><span class='line'>        <span class="nx">app</span><span class="p">.</span><span class="nx">todoList</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">addOne</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">newAttributes</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">title</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">().</span><span class="nx">trim</span><span class="p">(),</span>
</span><span class='line'>          <span class="nx">completed</span><span class="o">:</span> <span class="kc">false</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//--------------</span>
</span><span class='line'>    <span class="c1">// Initializers</span>
</span><span class='line'>    <span class="c1">//--------------   </span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">app</span><span class="p">.</span><span class="nx">appView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">app</span><span class="p">.</span><span class="nx">AppView</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Continue with the <a href="/blog/2012/09/13/backbonejs-for-absolute-beginners-getting-started-part-3/">3rd part</a> and learn how to make CRUD for your models!</h3>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/11/backbone-dot-js-for-absolute-beginners-getting-started/">Backbone.js for Absolute Beginners - Getting Started (Part 1: Intro)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-09-11T22:50:00-04:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>10:50 pm</span></time>
        
           | <a href="/blog/2012/09/11/backbone-dot-js-for-absolute-beginners-getting-started/#disqus_thread"
             data-disqus-identifier="http://adrianmejia.com/blog/2012/09/11/backbone-dot-js-for-absolute-beginners-getting-started/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Backbone.js is a JavaScript framework, among many others, that is gaining special attention in the web development community because it&rsquo;s ease of use and the structure that it provides to JavaScript applications.</p>

<p>(Updated: 2013-02-02, 2013-11-24)</p>

<h3>Brief Background (optional reading)</h3>

<p><a href="#start">TL; DR</a>: You need to use JavaScript heavily in order to make responsive and interactive web applications. <a href="#start">Jump to this and get started.</a></p>

<p>The web application development process has been evolving over the years. In the beginning web applications were just static HTML pages, which required programmers to change the code (HTML, CSS, JS) in order to change the content. Later, in web 2.0, server side programming languages (like PHP, Ruby, Java, …) were added to generate HTML pages dynamically based on user input and data stored in database. That was a huge improvement, and most of the pages served today use this approach. However, to provide the web site with even more responsiveness, speed, and enhanced user interaction, it requires bringing the logic closer to the client (browser).  There are a couple of languages that can run in the browsers besides JS, such as Java, Flash and others. However, these require extra plugins and are not as ubiquitous as JavaScript.</p>

<p>Web applications nowadays require heavy use of JavaScript to generate content on the fly. The user needn&rsquo;t wait between requests and page refreshes. A lot of the logic/code that used to be on the server side is being moved to the client side. JS allows web sites to render only content that changes without needing to reload the full-page on every request. Examples of this kind of web applicqtion are Gmail, Pandora, Pinterest, Nokia Maps 3D and others.</p>

<p>A common problem with large JS web application developed is that they can become pretty messy really quickly. The lack of structure makes the code hard to maintain. This is where Backbone comes into play. It provides structure to organize the code and increase maintainability. Backbone is not the only framework like this; in fact, there are many JS frameworks that attempt to offer similar benefits, like Ember.js, Angular.js and so on. However, I choose Backbone because it&rsquo;s one of the most widely used frameworks in its category. It has a vibrant community and it’s also being fully used in production for a considerable number of big companies like: Wal-Mart mobile, Groupon, Khan Academy, Pandora, Wordpress, Foursquare, and so on.</p>

<p><a id="start"></a></p>

<h2>Just enough to get started with Backbone.js</h2>

<p>Backbone.js has hard dependency on underscore.js and a soft dependency on jQuery. It’s made up of the following modules:</p>

<ul>
<li> Views</li>
<li> Events</li>
<li> Models</li>
<li> Collections</li>
<li> Routers</li>
</ul>


<h2>Shut up and show me the code!</h2>

<p>Alright! the way we are going to explore all of these modules is through examples. This is a practical tutorial that I wished I had it when I stared learning. This is a fat-free walkthrough of Backbone.js, as simple as possible, with all the code in one file for didactical purposes (no hidden magic tricks, all cards are on the table).</p>

<p>The first example is a ‘Hello World’ app in Backbone and the second is a &lsquo;to do&rsquo; app. After working through these two example apps, you’ll see every Backbone module and have a practical understanding about them.</p>

<h2>1. Hello World in Backbone.js</h2>

<p>You can follow along with this tutorial&rsquo;s code in this <a href="https://github.com/amejiarosario/Backbone-tutorial/commits/">repository</a>. Each feature implemented is a new commit, so you can easily see what changed in every step.</p>

<p><strong>1.1.- Simple HTML5 and Backbone boilerplate</strong></p>

<p>To get started, download <a href="https://raw.github.com/amejiarosario/Backbone-tutorial/439ff34409dfc01adca7f9f96efcd726295f1aac/backbone-tutorial.html">this simple html file</a>. This file  contains the libraries that you&rsquo;ll need (jQuery, Underscore.js, Backbone.js and Backbone-localStorage.js) and the placeholders for your HTML and JS code. Don&rsquo;t worry about the libraries, we are going to explain them as we need them.</p>

<p>After downloading the aformentioned file, notice the HTML where your entire page will be built using Backbone.Views!</p>

<p>Your entire js app will be loaded here:</p>

<p><code>&lt;div id="container"&gt;Loading...&lt;/div&gt;</code></p>

<p><a id="1.2"></a>
<strong>1.2.- Backbone&rsquo;s Views</strong></p>

<p>Backbone&rsquo;s Views are the equivalent of ‘controllers’ on MVC frameworks (like Ruby on Rails), if you are not familiar with MVC frameworks, that&rsquo;s okay. Backbone&rsquo;s Views glue together user events (clicks, pressed keys, etc.), render HTML views and templates, and interact with models which contains the data of the application.</p>

<p>Here is an example of a Backbone.view: READ THE CODE AND COMMENTS, then insert this code in the javascript block of the HTML file you downloaded.</p>

<figure class='code'><figcaption><span>Simple Backbone.View</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/0bf69185f4463a75cb2d5553f8d1ea197323ccff/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="kd">var</span> <span class="nx">AppView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>      <span class="c1">// el - stands for element. Every view has a element associate in with HTML</span>
</span><span class='line'>      <span class="c1">//      content will be rendered.</span>
</span><span class='line'>      <span class="nx">el</span><span class="o">:</span> <span class="s1">&#39;#container&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="c1">// It&#39;s the first function called when this view it&#39;s instantiated.</span>
</span><span class='line'>      <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="c1">// $el - it&#39;s a cached jQuery object (el), in which you can use jQuery functions</span>
</span><span class='line'>      <span class="c1">//       to push content. Like the Hello World in this case.</span>
</span><span class='line'>      <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>1.3.- Test the app</strong></p>

<p>After copying the code, open the file, refresh the browser and you should see the &lsquo;Hello World&rsquo; message, right? Wait, if you&rsquo;re just seeing the &lsquo;Loading…&rsquo; it&rsquo;s because you need to initialize the view first.</p>

<p><code>var appView = new AppView();</code></p>

<p>Yay! You have your &ldquo;Hello Wold&rdquo; in Backbone and an introduction to the View module. (Full code is <a href="https://raw.github.com/amejiarosario/Backbone-tutorial/0bf69185f4463a75cb2d5553f8d1ea197323ccff/backbone-tutorial.html">here</a>)</p>

<p><strong>1.4.- Backbone&rsquo;s Templates</strong></p>

<p>Backbone has a utility/helper library called <a href="http://underscorejs.org/?utm_source=adrianmejia.com">underscore.js</a> and you can use their template solution out of box. You can also use any other template solution that you want like <a href="https://github.com/janl/mustache.js">mustache</a> or <a href="https://github.com/wycats/handlebars.js">handlebars</a>. Let&rsquo;s stick with _.js for simplicity&rsquo;s sake.</p>

<p>_.js templates have the following syntax,</p>

<p><code>_.template(templateString, [data], [settings])</code></p>

<p>where in the <code>templateString</code> you use the place holder <code>&lt;%= %&gt;</code> and <code>&lt;%- %&gt;</code> to dynamically insert data. The later allows for HTML escape while the first one doesn&rsquo;t. Moreover, you can use <code>&lt;% %&gt;</code> to run any javascript code.</p>

<p>Let’s see it in action and rewrite our &ldquo;Hello World&rdquo; using a _.js template instead.</p>

<figure class='code'><figcaption><span>Simple Backbone.View and Templates</span><a href='https://raw.github.com/amejiarosario/Backbone-tutorial/c5b131278ecde92f33882c9a2c22ee4119e57d77/backbone-tutorial.html'>Full Code </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="kd">var</span> <span class="nx">AppView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">el</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#container&#39;</span><span class="p">),</span>
</span><span class='line'>      <span class="c1">// template which has the placeholder &#39;who&#39; to be substitute later</span>
</span><span class='line'>      <span class="nx">template</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;&lt;h3&gt;Hello &lt;%= who %&gt;&lt;/h3&gt;&quot;</span><span class="p">),</span>
</span><span class='line'>      <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="c1">// render the function using substituting the varible &#39;who&#39; for &#39;world!&#39;.</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">template</span><span class="p">({</span><span class="nx">who</span><span class="o">:</span> <span class="s1">&#39;world!&#39;</span><span class="p">}));</span>
</span><span class='line'>        <span class="c1">//***Try putting your name instead of world.</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">appView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AppView</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run the app again and verify that it&rsquo;s working with the template.</p>

<h3>Continue with the <a href="/blog/2012/09/13/backbone-js-for-absolute-beginners-getting-started-part-2/">2nd part</a> and learn more about Backbone&rsquo;s Models, Collections, View and Events!</h3>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/05/06/instagram-mobile-design-secrets-revealed/">Instagram Mobile Design Secrets Revealed</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-05-06T21:45:00-04:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>9:45 pm</span></time>
        
           | <a href="/blog/2012/05/06/instagram-mobile-design-secrets-revealed/#disqus_thread"
             data-disqus-identifier="http://adrianmejia.com/blog/2012/05/06/instagram-mobile-design-secrets-revealed/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Instagram is a very nice iPhone App. It allows you to give effects to your photos easily. Additionally, it’s blazing fast to upload your photos, and share them in other social networks such as Facebook, Twitter and/or Foursquare.</p>

<p>This app went from 0 to 12 million users in just 12 months! And today 30+ million users in less than 2 years. Go through the slideshows bellow and you can see why. This app has some design features that that improves a lot the user experience. One of them, it’s responding to the user actions instantly even though the task is still performing in the background… more details in the slide:</p>

<script async class="speakerdeck-embed" data-id="4ede6e9cad0da6004d000175" data-ratio="1.299492385786802" src="//speakerdeck.com/assets/embed.js"></script>


<p>Scaling Instagram has also an interesting history:</p>

<script async class="speakerdeck-embed" data-id="4f86746753373601f1006e39" data-ratio="1.3333333333333333" src="//speakerdeck.com/assets/embed.js"></script>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/27/blog-migration-explained-drupal-7-to-jekyll/">Blog Migration Explained: Drupal 7 to Jekyll</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-04-27T22:00:00-04:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>10:00 pm</span></time>
        
           | <a href="/blog/2012/04/27/blog-migration-explained-drupal-7-to-jekyll/#disqus_thread"
             data-disqus-identifier="http://adrianmejia.com/blog/2012/04/27/blog-migration-explained-drupal-7-to-jekyll/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This post is a guide on how to extract your blog posts information from Drupal 7 to other systems. And also automatically create a redirect files from the old blog to the new one. In this case, I migrated to Jerkyll/Octopress blog but from the data extracted in with my script you can migrate any other blog system. Hopefully, this will save you a lot of time if you need to do the same task. If you run into troubles go to last section of the post it has some suggestions.</p>

<h2>Extract data from Drupal 7 site</h2>

<h3>SQL extraction</h3>

<p>You need to extract the data from your Drupal 7, there are several ways. You can connect to your web host via ssh and generate SQL dump.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="n">mysqldump</span> <span class="err">–</span><span class="n">uUSERNAME</span> <span class="err">–</span><span class="n">pPASSWORD</span> <span class="k">DATABASE</span> <span class="o">&gt;</span> <span class="n">FILENAME</span><span class="p">.</span><span class="k">sql</span>
</span></code></pre></td></tr></table></div></figure>


<p>(replace the UPPERCASE letters with your settings)</p>

<p>You can download the file *.sql to your computer and run the following command to install to upload the data in your local database.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="n">mysql</span> <span class="err">–</span><span class="n">uUSERNAME</span> <span class="err">–</span><span class="n">pPASSWORD</span> <span class="k">DATABASE</span> <span class="o">&lt;</span> <span class="n">FILENAME</span><span class="p">.</span><span class="k">sql</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you have a access to you phpmyadmin in your host server you can download your sql dump file through that also. Other method is to use a local port fordwarding using SSH… anyways, get access to your database.</p>

<h3>Run the script</h3>

<p>The 2nd and final step is to run the script that does all the magic. Below I will explain how it works in case that you want to customize.</p>

<div><script src='https://gist.github.com/2515239.js?file=drupal2jekyll.rb'></script>
<noscript><pre><code># 
# Jekyll migrator for Drupal 7+
# adrianmejia.com
#

require &#39;rubygems&#39;
require &#39;sequel&#39;
require &#39;fileutils&#39;
require &#39;yaml&#39;

# NOTE: This converter requires Sequel and the MySQL gems.
# The MySQL gem can be difficult to install on OS X. Once you have MySQL
# installed, running the following commands should work:
# $ sudo gem install sequel
# $ sudo gem install mysql -- --with-mysql-config=/usr/local/mysql/bin/mysql_config
#
# UPDATE:
# Install mysql2 as well you might need it as well.
# $ gem install mysql2 -- --with-mysql-config=/usr/local/mysql/bin/mysql_config
#

OLD_DOMAIN = &quot;http://adrianmejiarosario.com&quot;  ## TODO replace this out
NEW_DOMAIN = &quot;http://adrianmejia.com&quot;         ## TODO replace this out


module Jekyll
  module Drupal
    # Reads a MySQL database via Sequel and creates a post file for each post
    # in wp_posts that has post_status = &#39;publish&#39;. This restriction is made
    # because &#39;draft&#39; posts are not guaranteed to have valid dates.
    
    QUERY =&lt;&lt;SQL 
    SELECT 
    n.nid, 
    n.title, 
    n.created, 
    n.changed, 
    b.body_value AS &#39;body&#39;, 
    b.body_summary, 
    b.body_format, 
    n.status, 
    l.alias AS &#39;slug&#39;, 
    GROUP_CONCAT( d.name SEPARATOR &#39;, &#39; ) AS &#39;tags&#39;
    
    FROM dr_url_alias l, dr_node n
    JOIN dr_field_data_body b ON b.entity_id = n.nid
    JOIN dr_taxonomy_index t ON t.nid = n.nid
    JOIN dr_taxonomy_term_data d ON t.tid = d.tid

    WHERE n.type = &#39;blog&#39;
    AND b.revision_id = n.vid
    AND l.source = CONCAT( &#39;node/&#39;, n.nid ) 

    GROUP BY n.nid
SQL

    #
    # Main script
    # 
    def self.process(dbname, user, pass, host = &#39;localhost&#39;)
      db = Sequel.mysql(dbname, :user =&gt; user, :password =&gt; pass, :host =&gt; host, :encoding =&gt; &#39;utf8&#39;)

      drupal_path = &quot;drupal_redirect&quot;
      FileUtils.mkdir_p drupal_path
           
      File.open(&quot;#{drupal_path}/index.php&quot;, &quot;w&quot;) { |f| f.puts permanent_redirect_to (&quot;&quot;) }
      FileUtils.mkdir_p &quot;_posts&quot;
      FileUtils.mkdir_p &quot;_drafts&quot;


      db[QUERY].each do |post|
        # Get required fields and construct Jekyll compatible name
        node_id = post[:nid]
        title = post[:title]
        
        # complete relatives URLs
        content = post[:body].gsub(&quot;\&quot;/sites/default/files/&quot;, &quot;\&quot;#{OLD_DOMAIN}/sites/default/files/&quot;)
        
        created = post[:created]
        tags = post[:tags].downcase.strip
        drupal_slug = post[:slug]
        time = Time.at(created)
        is_published = post[:status] == 1
        dir = is_published ? &quot;_posts&quot; : &quot;_drafts&quot;
        slug = title.strip.downcase.gsub(/(&amp;|&amp;amp;)/, &#39; and &#39;).gsub(/[\s\.\/\\]/, &#39;-&#39;).gsub(/[^\w-]/, &#39;&#39;).gsub(/[-_]{2,}/, &#39;-&#39;).gsub(/^[-_]/, &#39;&#39;).gsub(/[-_]$/, &#39;&#39;)
        name = time.strftime(&quot;%Y-%m-%d-&quot;) + slug + &#39;.md&#39;

        # Get the relevant fields as a hash, delete empty fields and convert
        # to YAML for the header
        data = {
           &#39;layout&#39; =&gt; &#39;post&#39;,
           &#39;title&#39; =&gt; title.to_s,
           &#39;created&#39; =&gt; created,
           &#39;comments&#39; =&gt; true,
           &#39;categories&#39; =&gt; tags
         }.delete_if { |k,v| v.nil? || v == &#39;&#39;}.to_yaml

        # Write out the data and content to file
        File.open(&quot;#{dir}/#{name}&quot;, &quot;w&quot;) do |f|
          f.puts data.gsub /categories:\W+(.+)/, &#39;categories: [\1]&#39;
          f.puts &quot;---&quot;
          f.puts content
        end

        # 
        # Make a file to redirect from the old Drupal URL
        # Make refresh dirs &amp; files according to entries in url_alias table in drupal 7+
        # Copy the content to your drupal_redirect to the root of your all blog and that&#39;s it. It will redirect to your new site.
        #
        if is_published
          ddir = &quot;#{drupal_path}/#{drupal_slug}&quot;
          FileUtils.mkdir_p ddir
          File.open(&quot;#{ddir}/index.php&quot;, &quot;w&quot;) do |f|
            puts &quot;#{ddir}/index.php&quot;
            f.puts permanent_redirect_to &quot;blog/#{time.strftime(&quot;%Y/%m/%d/&quot;) + slug}&quot;
          end
        end
      end

      # TODO: Make dirs &amp; files for nodes of type &#39;page&#39;
      # Make refresh pages for these as well
    end    
  end
end

#
# PHP code to redirect permanently your users from your old website to your new
#
def permanent_redirect_to(location)
  &quot;&lt;?php\nheader(\&quot;HTTP/1.1 301 Moved Permanently\&quot;);\nheader(\&quot;Location: #{NEW_DOMAIN}/#{location}\&quot;);\necho \&quot;redirecting...\&quot;\n ?&gt;&quot;
end

Jekyll::Drupal.process(ENV[&#39;DRUPAL_DATABASE&#39;],ENV[&#39;DB_USER&#39;],ENV[&#39;DB_PASSWORD&#39;])</code></pre></noscript></div>


<p>Replace the place holders with your actual values:</p>

<ul>
<li>OLD_DOMAIN</li>
<li>NEW_DOMAIN</li>
<li>ENV[&lsquo;DRUPAL_DATABASE&rsquo;]</li>
<li>ENV[&lsquo;DB_USER&rsquo;]</li>
<li>ENV[&lsquo;DB_PASSWORD&rsquo;]</li>
</ul>


<p>After you run it, it will generate 3 folders:</p>

<ul>
<li>_post: has all your post in the Jekyll style (categories and tags and everything)</li>
<li>_draft: not published posts if any</li>
<li>drupal_redirect: for each url of your posts it has a folder with a redirect index.php file to your new domain.</li>
</ul>


<p>Copy each of this folder to their respective places. Copy the content to your drupal_redirect to the root of your old blog and that&rsquo;s it. It will redirect all your all blog URLs to your new site.</p>

<h3>Behind the scenes…</h3>

<p>First, you need to extract the data from your Drupal site. I reversed engineer the database in order to extract the post, title, url alias (slug), tags, publish info, format and the last version of the post. The query that does all the magic is the following one:</p>

<figure class='code'><figcaption><span>Drupal 7 Query to extract all the post info </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'><span class="n">n</span><span class="p">.</span><span class="n">nid</span><span class="p">,</span>
</span><span class='line'><span class="n">n</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
</span><span class='line'><span class="n">n</span><span class="p">.</span><span class="n">created</span><span class="p">,</span>
</span><span class='line'><span class="n">n</span><span class="p">.</span><span class="n">changed</span><span class="p">,</span>
</span><span class='line'><span class="n">b</span><span class="p">.</span><span class="n">body_value</span> <span class="k">AS</span> <span class="s1">&#39;body&#39;</span><span class="p">,</span>
</span><span class='line'><span class="n">b</span><span class="p">.</span><span class="n">body_summary</span><span class="p">,</span>
</span><span class='line'><span class="n">b</span><span class="p">.</span><span class="n">body_format</span><span class="p">,</span>
</span><span class='line'><span class="n">n</span><span class="p">.</span><span class="n">status</span><span class="p">,</span>
</span><span class='line'><span class="n">l</span><span class="p">.</span><span class="k">alias</span> <span class="k">AS</span> <span class="s1">&#39;slug&#39;</span><span class="p">,</span>
</span><span class='line'><span class="n">GROUP_CONCAT</span><span class="p">(</span> <span class="n">d</span><span class="p">.</span><span class="n">name</span> <span class="n">SEPARATOR</span> <span class="s1">&#39;, &#39;</span> <span class="p">)</span> <span class="k">AS</span> <span class="s1">&#39;tags&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">FROM</span> <span class="n">url_alias</span> <span class="n">l</span><span class="p">,</span> <span class="n">node</span> <span class="n">n</span>
</span><span class='line'><span class="k">JOIN</span> <span class="n">field_data_body</span> <span class="n">b</span> <span class="k">ON</span> <span class="n">b</span><span class="p">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><span class="n">nid</span>
</span><span class='line'><span class="k">JOIN</span> <span class="n">taxonomy_index</span> <span class="n">t</span> <span class="k">ON</span> <span class="n">t</span><span class="p">.</span><span class="n">nid</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><span class="n">nid</span>
</span><span class='line'><span class="k">JOIN</span> <span class="n">taxonomy_term_data</span> <span class="n">d</span> <span class="k">ON</span> <span class="n">t</span><span class="p">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">tid</span>
</span><span class='line'>
</span><span class='line'><span class="k">WHERE</span> <span class="n">n</span><span class="p">.</span><span class="k">type</span> <span class="o">=</span> <span class="s1">&#39;blog&#39;</span>
</span><span class='line'><span class="k">AND</span> <span class="n">b</span><span class="p">.</span><span class="n">revision_id</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><span class="n">vid</span>
</span><span class='line'><span class="k">AND</span> <span class="n">l</span><span class="p">.</span><span class="k">source</span> <span class="o">=</span> <span class="n">CONCAT</span><span class="p">(</span> <span class="s1">&#39;node/&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">.</span><span class="n">nid</span> <span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">GROUP</span> <span class="k">BY</span> <span class="n">n</span><span class="p">.</span><span class="n">nid</span>
</span></code></pre></td></tr></table></div></figure>


<p>As might notice, it concatenates all the tags separated by comma and also finds the alias of the url if is called node. Also you can also find the url alias for other pages such as terms or taxonomies. But let’s keep it simple and get the posts urls.</p>

<p>Finally, the script will use the data from this query to generate the new posts files and also to create the redirect files.</p>

<p>As might notice, it concatenates all the tags separated by comma and also finds the alias of the url if is called node. Also you can also find the url alias for other pages such as terms or taxonomies. But let’s keep it simple and get the posts urls.</p>

<p>Finally, the script will use the data from this query to generate the new posts files and also to create the redirect files.</p>

<h3>Troubleshooting</h3>

<p>I had a hard time having the mysql gem work with seqel in my Mac OS X 10.7 (Lion) and ruby 1.9.2.</p>

<p>I got the following errors:</p>

<ul>
<li>Library not loaded: libmysqlclient.18.dylib (LoadError)
Sequel::DatabaseConnectionError: Mysql::ClientError::ServerGoneError: The MySQL server has gone away mysql2 ruby</li>
<li>&ldquo;LoadError: require &lsquo;mysql&rsquo; did not define Mysql::CLIENT_MULTI_RESULTS!&rdquo;</li>
<li>&ldquo;You are probably using the pure ruby mysql.rb driver, which Sequel does not support. You need to install the C based adapter, and make sure that the mysql.so file is loaded instead of the mysql.rb file.&rdquo;</li>
<li>Sequel::AdapterNotFound: LoadError: require &lsquo;mysql&rsquo; did not define Mysql::CLIENT_MULTI_RESULTS! You are probably using the pure ruby mysql.rb driver, which Sequel does not support. You need to install the C based adapter, and make sure that the mysql.so file is loaded instead of the mysql.rb file.</li>
<li>And others…</li>
</ul>


<h4>Solution:</h4>

<p>The mysql gem have been abandoned, so you also need mysql2 to work propery with sequel</p>

<figure class='code'><figcaption><span>bash Install MySQL gems </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo gem install sequel
</span><span class='line'><span class="nv">$ </span>sudo gem install mysql -- --with-mysql-config<span class="o">=</span>/usr/local/mysql/bin/mysql_config
</span><span class='line'><span class="nv">$ </span>sudo gem install mysql2 -- --with-mysql-config<span class="o">=</span>/usr/local/mysql/bin/mysql_config
</span></code></pre></td></tr></table></div></figure>


<p>also  you need to copy the following lib:</p>

<figure class='code'><figcaption><span>Reference needed libs </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib
</span></code></pre></td></tr></table></div></figure>


<p>That should work.</p>

<p>Just if you are courious there is another gem called ruby-mysql, with which you can connect to mysql. But it doesn’t work with sequel</p>

<figure class='code'><figcaption><span>Alternative gem to connect to mysql (ruby-mysql) </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gem install ruby-mysql -- --with-mysql-config<span class="o">=</span>/usr/local/mysql/bin/mysql_config
</span><span class='line'><span class="nv">$ </span>irb
</span><span class='line'>&gt; require <span class="s1">&#39;mysql&#39;</span>
</span><span class='line'>&gt; <span class="nv">db</span> <span class="o">=</span> Mysql.real_connect<span class="o">(</span><span class="s2">&quot;SERVER&quot;</span>,<span class="s2">&quot;USER&quot;</span>,<span class="s2">&quot;PASSWORD&quot;</span>,<span class="s2">&quot;DATABASE&quot;</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/27/spring-mvc-3-plus-ajax-getjson-and-solving-406-not-accepted/">Spring MVC 3 + AJAX (getJSON) and Solving 406 Not Accepted</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-04-27T02:17:00-04:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>2:17 am</span></time>
        
           | <a href="/blog/2012/04/27/spring-mvc-3-plus-ajax-getjson-and-solving-406-not-accepted/#disqus_thread"
             data-disqus-identifier="http://adrianmejia.com/blog/2012/04/27/spring-mvc-3-plus-ajax-getjson-and-solving-406-not-accepted/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I wanted to add AJAX to Spring MVC application. So, I did what most us do, go through the documentation or blog of the Spring Source. But, after playing around I didn&#8217;t get it to work properly so here are some details that might save you some time.</p>


<p>After I follow the instructions in <a href="http://blog.springsource.org/2010/01/25/ajax-simplifications-in-spring-3-0/%20" target="_blank">AJAX in Spring 3.0</a> I got some error &#8220;406 Not Accepted&#8221;, so let&#8217;s explain how to make it work:</p>


<h2>Server Side</h2>


<p>First you need to setup the actions/methods that the ajax client will call and provide that data in a request. In the server side we are going to use Spring MVC and reply using a JSON format.</p>


<p>1. You need the annotation <strong>&lt;mvc:annotation-driven /&gt;</strong> in your spring.xml or servelet-web-context.xml<br />2. Then, you need to create your controller action that will reply to the AJAX invocation. Let&#8217;s see the following example. E.g. ProductController.java&nbsp;</p>


<pre>@RequestMapping (value="/itemdescription", method=RequestMethod.GET, headers="Accept=application/json")<br />public <strong>@ResponseBody</strong> Product getItemDescription(@RequestParam String id){ <br />// code... <br />return yourProduct<br />}</pre>


<p>There are a couple of things to point out here. Notice the return @ResponseBody Product type. So, you need to create create a POJO (Plain java class with the data that you want to send along with it&#8217;s getters and setters). E.g. Product.java.&nbsp;</p>


<p>Also, notice the @ResponseBody annotation. This annotation allow you to translate the Product object into a JSON representation. But, this is not magic! and you need a couple of JARs to make it work (additionally to the annotation metined in step (1):</p>


<ol>
<li>http://mvnrepository.com/artifact/org.codehaus.jackson/jackson-core-asl</li>
<li>http://mvnrepository.com/artifact/org.codehaus.jackson/jackson-mapper-asl</li>
</ol>


<p>Use maven or download and place this JARs in the lib manually.</p>


<h2>Client Side</h2>


<p>On the client side, I&#8217;m using jQuery and the code looks like this:</p>


<pre>var jqxhr = $.getJSON("/&lt;your-servlet-name&gt;/itemdescription?id="+ itemId, function(result) {<br />&nbsp; //res=jQuery.stringify(result);<br /><br />&nbsp; if(result != null){<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $.each(result, function(key, value) {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if(key==="descr"){ <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; descr.val(value);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; userdescr.val(value);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; });<br />&nbsp;&nbsp;&nbsp; } else {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; descr.val("");<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; userdescr.val("");<br />&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <br />})<br />// .success(function() { console.log("2nd function second success"); })<br />.error(function(XMLHttpRequest, textStatus, errorThrown) { console.log("error "+textStatus+": "+errorThrown); })<br />// .complete(function() { console.log("complete"); });</pre>


<p>There are some function there that are useful for debugging like printing out errors to the console and complete function. Notice also that $.getJSON is expenting the reponse in of a appplication/json type. So be sure that you have the &#8220;Accept=application/json&#8221; in your controller on the server side.</p>


<p>Finally you can customize the javascript fragment shown above and place it in your webpage (JSP, HTML,&#8230;) in a ready document. (Also, It was also useful for me to add a delay after the document ready function because otherwise it conflicted with dojo framework apply to the same component. But remove the timeout if you want to)</p>


<pre>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $(document).ready(function() {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; console.log("document.ready");<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; setTimeout(function(){<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $(_itemId).keyup(function(){checkItemId($(_itemId).val(), $(_descr), $(_userdescr));});<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $(_itemId).blur(function(){checkItemId($(_itemId).val(), $(_descr), $(_userdescr));});&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; },100);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; });</pre>


<p>&nbsp;</p>


<p>&nbsp;That&#8217;s all you need.</p>


<h2>Troubleshooting</h2>


<p>As mentioned before the spring mvc blog explain more in details each of the steps but lack some minor details that are key to make it work. I was getting &#8220;406 Not Accepted&#8221; because I didn&#8217;t have the jackson jars that the @ResponseBody needs to convert java objects to JSON. And also you need to add the Accept Request header in the controller.</p>


<p>Using Firebug in Firefox is very tab Net &gt; XHR you can see all your ajax request and reponses. Very useful for debugging. Hope this save you some time and frustration. Any question or suggestion fee free to comment below or contact me.</p>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/03/09/how-company-x-make-money/">How Company X Make Money?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/15/cheap-airplay-receiver-with-raspberry-pi/">Cheap Airplay Receiver With Raspberry Pi</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/13/algorithms-for-dummies-part-1-sorting/">Algorithms for Dummies (Part 1): Big-O Notation and Sorting</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/13/backbone-js-for-absolute-beginners-getting-started-part-4/">Backbone.js for Absolute Beginners - Getting Started (Part 4: Routers)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/13/backbonejs-for-absolute-beginners-getting-started-part-3/">Backbone.js for Absolute Beginners - Getting Started (Part 3: CRUD)</a>
      </li>
    
  </ul>
</section>

<section class="googleplus">
  <h1>
    <a href="http://www.linkedin.com/in/adrianmejia">
      <img src="/images/linkedin.png" width="32" height="32">
      Linkedin
    </a>
  </h1>
</section>


<section class="googleplus">
  <h1>
    <a href="https://github.com/amejiarosario">
      <img src="/images/github.png" width="32" height="32">
      Github
    </a>
  </h1>
</section>


<section class="googleplus">
  <h1>
    <a href="https://twitter.com/amejiarosario">
      <img src="/images/twitter.png" width="32" height="32">
      Twitter
    </a>
  </h1>
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/105957252272382685246?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/amejiarosario">@amejiarosario</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'amejiarosario',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Adrian Mejia -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'adrianmejia';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
